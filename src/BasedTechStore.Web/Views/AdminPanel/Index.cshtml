@using BasedTechStore.Web.ViewModels.AdminPanel
@model AdminPanelVM

<h2>Адмін панель</h2>

<ul class="nav nav-tabs mt-3" id="adminTab" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="products-tab" data-bs-toggle="tab" data-bs-target="#productsContainer" type="button" role="tab">Товари</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="orders-tab" data-bs-toggle="tab" data-bs-target="#orders" type="button" role="tab">Замовлення</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab">Користувачі</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categoriesContainer" type="button" role="tab">Категорії</button>
    </li>
</ul>

<div class="tab-content" id="adminTabContent">
    <div class="tab-pane fade show active p-3" id="productsContainer" role="tabpanel">
        @await Html.PartialAsync("_ManageProductsPartial", Model.Products)
    </div>
    <div class="tab-pane fade p-3" id="orders" role="tabpanel">
        <p>Тут буде управління замовленнями.</p>
    </div>
    <div class="tab-pane fade p-3" id="users" role="tabpanel">
        <p>Тут буде управління користувачами.</p>
    </div>
    <div class="tab-pane fade p-3" id="categoriesContainer" role="tabpanel">
        @await Html.PartialAsync("_ManageCategoriesPartial", Model.Categories)
    </div>
</div>

<div class="mt-4">
    <button class="btn btn-secondary" onclick="confirmBackToProfile()">Повернутися до профілю</button>
</div>

<script>
    function confirmBackToProfile() {
        const modal = window.modalHandlers ? window.modalHandlers["warningOnLeave"] : null;

        if (modal && modal.hasChanges) {
            // Якщо є незбережені зміни, показуємо попередження
            modal.setRedirectUrl('@Url.Action("Index", "Profile")');
            modal.show();
        } else {
            // Якщо немає незбережених змін, переходимо одразу
            window.location.href = '@Url.Action("Index", "Profile")';
        }
    }
</script>
<script src="~/js/edit-categories.js"></script>
<script src="~/js/edit-products.js"></script>